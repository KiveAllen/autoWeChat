# autoWeChat - å¾®ä¿¡è‡ªåŠ¨åŒ–æ“ä½œæ¡†æ¶

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„Pythonè‡ªåŠ¨åŒ–æ¡†æ¶ï¼Œä¸“ä¸ºWindowså¹³å°è®¾è®¡ï¼Œæ”¯æŒé€šè¿‡MQTTåè®®è¿œç¨‹æ§åˆ¶å¾®ä¿¡å®¢æˆ·ç«¯è¿›è¡Œæ¶ˆæ¯å‘é€ã€æ–‡ä»¶ä¼ è¾“ç­‰æ“ä½œã€‚

> âš ï¸ **å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®ä»…ä¾›æŠ€æœ¯ç ”ç©¶å’Œå­¦ä¹ ä½¿ç”¨ï¼Œè¯·ä¸¥æ ¼éµå®ˆå¾®ä¿¡å¹³å°ä½¿ç”¨æ¡æ¬¾åŠç›¸å…³æ³•å¾‹æ³•è§„ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ å¤šæ¨¡å¼è¿è¡Œ
- **ç›´æ¥è°ƒç”¨æ¨¡å¼**ï¼šé€šè¿‡Python APIç›´æ¥è°ƒç”¨å¾®ä¿¡è‡ªåŠ¨åŒ–åŠŸèƒ½
- **MQTTè¿œç¨‹æ§åˆ¶æ¨¡å¼**ï¼šæ”¯æŒé€šè¿‡MQTTåè®®è¿œç¨‹è§¦å‘å¾®ä¿¡æ¶ˆæ¯å‘é€
- **å¼‚æ­¥é˜Ÿåˆ—å¤„ç†**ï¼šå†…ç½®æ¶ˆæ¯é˜Ÿåˆ—æœºåˆ¶ï¼Œæ”¯æŒé«˜å¹¶å‘æ¶ˆæ¯å¤„ç†

### ğŸ“¨ æ¶ˆæ¯å‘é€èƒ½åŠ›
- âœ… **æ–‡æœ¬æ¶ˆæ¯**ï¼šæ”¯æŒçº¯æ–‡æœ¬ã€Emojiè¡¨æƒ…ã€ç‰¹æ®Šå­—ç¬¦å‘é€
- âœ… **æ–‡ä»¶ä¼ è¾“**ï¼šæ”¯æŒæœ¬åœ°æ–‡ä»¶å’Œç½‘ç»œå›¾ç‰‡URLå‘é€
- âœ… **æ‰¹é‡æ“ä½œ**ï¼šå¯åŒæ—¶å‘å¤šä¸ªè”ç³»äºº/ç¾¤èŠå‘é€æ¶ˆæ¯
- âœ… **æ··åˆå‘é€**ï¼šæ”¯æŒæ–‡æœ¬+æ–‡ä»¶ç»„åˆå‘é€

### ğŸ¯ æ™ºèƒ½è¯†åˆ«æŠ€æœ¯
- ğŸ” **å›¾åƒè¯†åˆ«**ï¼šåŸºäºOpenCVçš„æ¨¡æ¿åŒ¹é…æŠ€æœ¯ç²¾ç¡®å®šä½ç•Œé¢å…ƒç´ 
- ğŸ“ **åç§»ç‚¹å‡»**ï¼šç‹¬ç‰¹çš„å›¾åƒä¸‹æ–¹å›ºå®šåƒç´ ç‚¹å‡»æœºåˆ¶ï¼ˆç”¨æˆ·åå¥½ï¼‰
- ğŸ”„ **æ™ºèƒ½é‡è¯•**ï¼šè‡ªåŠ¨é‡è¯•æœºåˆ¶ç¡®ä¿æ“ä½œæˆåŠŸç‡
- ğŸ›¡ï¸ **é˜²åå­—å¤„ç†**ï¼šè‡ªåŠ¨å¤„ç†å¾®ä¿¡Emojiæ˜¾ç¤ºå¼‚å¸¸é—®é¢˜

### âš™ï¸ ç³»ç»Ÿé›†æˆ
- ğŸŒ **MQTTåè®®**ï¼šæ”¯æŒæ ‡å‡†MQTTåè®®é€šä¿¡
- ğŸ”§ **é…ç½®ç®¡ç†**ï¼šçµæ´»çš„é…ç½®ç³»ç»Ÿæ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²
- ğŸ“Š **æ—¥å¿—ç›‘æ§**ï¼šå®Œå–„çš„æ—¥å¿—è®°å½•å’ŒçŠ¶æ€åé¦ˆ
- ğŸ”„ **è‡ªåŠ¨æ¢å¤**ï¼šæ–­çº¿é‡è¿å’Œå¼‚å¸¸æ¢å¤æœºåˆ¶

## ğŸ›  æŠ€æœ¯æ¶æ„

```
autoWeChat/
â”œâ”€â”€ core/                  # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ wx_operation.py      # å¾®ä¿¡åŸºç¡€æ“ä½œç±»
â”‚   â””â”€â”€ wx_operation_service.py  # å¾®ä¿¡æœåŠ¡å±‚
â”œâ”€â”€ service/               # æœåŠ¡ç»„ä»¶
â”‚   â””â”€â”€ mqtt_service.py      # MQTTæœåŠ¡å®ç°
â”œâ”€â”€ utils/                 # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ image_clicker.py     # å›¾åƒè¯†åˆ«ç‚¹å‡»
â”‚   â”œâ”€â”€ clipboard_utils.py   # å‰ªè´´æ¿æ“ä½œ
â”‚   â””â”€â”€ window_utils.py      # çª—å£ç®¡ç†
â”œâ”€â”€ config/                # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.py          # ç³»ç»Ÿé…ç½®
â”œâ”€â”€ main.py               # ç›´æ¥è°ƒç”¨å…¥å£
â”œâ”€â”€ mqtt_main.py          # MQTTæœåŠ¡å…¥å£
â”œâ”€â”€ mqtt_main_build.py # Windowsæ‰“åŒ…è„šæœ¬
â””â”€â”€ mqtt_main.spec # PyInstalleré…ç½®æ–‡ä»¶
```

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

### ç³»ç»Ÿç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ**ï¼šWindows 10/11 (64ä½)
- **Pythonç‰ˆæœ¬**ï¼š3.8+
- **å¾®ä¿¡å®¢æˆ·ç«¯**ï¼šWindowsæ¡Œé¢ç‰ˆå¾®ä¿¡

### Pythonä¾èµ–
```bash
pip install -r requirements.txt
```

**æ ¸å¿ƒä¾èµ–åŒ…**ï¼š
- `uiautomation~=2.0.18` - Windows UIè‡ªåŠ¨åŒ–
- `paho-mqtt~=2.1.0` - MQTTå®¢æˆ·ç«¯
- `opencv-python>=4.5.0` - å›¾åƒå¤„ç†
- `pyautogui>=0.9.50` - é¼ æ ‡é”®ç›˜æ§åˆ¶
- `pywin32>=306` - Windows APIæ¥å£
- `pythoncom` - COMç»„ä»¶æ”¯æŒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç›´æ¥è°ƒç”¨æ¨¡å¼

```python
from core import WxOperation

def main():
    # åˆå§‹åŒ–å¾®ä¿¡æ“ä½œå®ä¾‹
    wx = WxOperation()
    
    # å‘é€æ–‡æœ¬æ¶ˆæ¯
    wx.send_msg(
        name='æµ‹è¯•ç¾¤èŠ',
        msgs=['Hello World!', 'è¿™æ˜¯ä¸€æ¡è‡ªåŠ¨å‘é€çš„æ¶ˆæ¯ ğŸš€'],
        file_paths=['path/to/image.jpg']
    )

if __name__ == '__main__':
    main()
```

### 2. MQTTè¿œç¨‹æ§åˆ¶æ¨¡å¼

```python
from service import WxMqtt

# é…ç½®MQTTæœåŠ¡
mqtt_client = WxMqtt(
    mqtt_server="your-mqtt-server.com",
    mqtt_port=1883,
    mqtt_username="username",
    mqtt_password="password",
    subscribe_topic="wx/control"
)

# å¯åŠ¨æœåŠ¡
mqtt_client.start()
```

### 3. MQTTæ¶ˆæ¯æ ¼å¼

é€šè¿‡MQTTå‘é€ä»¥ä¸‹JSONæ ¼å¼æ¶ˆæ¯æ¥æ§åˆ¶å¾®ä¿¡ï¼š

```json
{
  "method": "sendWechatMessage",
  "chatNames": ["ç¾¤èŠ1", "å¥½å‹A"],
  "messages": ["é€šçŸ¥å†…å®¹", "ç¬¬äºŒæ¡æ¶ˆæ¯"],
  "imageUrls": ["http://example.com/image.jpg"]
}
```

## ğŸ“– APIæ–‡æ¡£

### æ ¸å¿ƒç±»è¯´æ˜

#### `WxOperation` - å¾®ä¿¡åŸºç¡€æ“ä½œç±»
```python
class WxOperation:
    def send_msg(self, name: str, msgs=None, file_paths=None, 
                 text_interval=0.05, file_interval=0.25, 
                 send_shortcut='{Enter}') -> None:
        """
        å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šè”ç³»äºº
        
        Args:
            name: æ¥æ”¶æ–¹åç§°ï¼ˆå¥½å‹/ç¾¤èŠï¼‰
            msgs: æ–‡æœ¬æ¶ˆæ¯åˆ—è¡¨
            file_paths: æ–‡ä»¶è·¯å¾„åˆ—è¡¨
            text_interval: æ–‡æœ¬å‘é€é—´éš”
            file_interval: æ–‡ä»¶å‘é€é—´éš”
            send_shortcut: å‘é€å¿«æ·é”®
        """
```

#### `WeChatService` - å¾®ä¿¡æœåŠ¡ç±»
```python
class WeChatService:
    def send_message_to_chats(self, chat_names: List[str], 
                            messages: Optional[List[str]] = None,
                            image_urls: Optional[List[str]] = None,
                            callback=None) -> dict:
        """
        å¼‚æ­¥å‘é€æ¶ˆæ¯åˆ°å¤šä¸ªèŠå¤©å¯¹è±¡
        """
```

#### `WxMqtt` - MQTTæœåŠ¡ç±»
```python
class WxMqtt:
    def start(self) -> None:
        """å¯åŠ¨MQTTæœåŠ¡"""
    
    def publish(self, topic: str, message: str):
        """å‘å¸ƒMQTTæ¶ˆæ¯"""
```

## âš™ï¸ é…ç½®è¯´æ˜

### å¾®ä¿¡é…ç½® (`config/config.py`)
```python
class WeChatConfig:
    WeChat_PROCESS_NAME = 'Weixin.exe'    # å¾®ä¿¡è¿›ç¨‹å
    WINDOW_NAME = 'å¾®ä¿¡'                   # çª—å£æ ‡é¢˜
    WINDOW_CLASSNAME = 'Qt51514QWindowIcon'  # çª—å£ç±»å

# æ—¶é—´é—´éš”é…ç½®
class IntervalConfig:
    BASE_INTERVAL = 0.1           # åŸºç¡€æ“ä½œé—´éš”
    SEND_TEXT_INTERVAL = 0.05     # æ–‡æœ¬å‘é€é—´éš”
    SEND_FILE_INTERVAL = 0.25     # æ–‡ä»¶å‘é€é—´éš”
```

### å›¾åƒè¯†åˆ«é…ç½®
```python
# utils/image_clicker.py
confidence = 0.8      # å›¾åƒåŒ¹é…åº¦é˜ˆå€¼
offset_y = 50         # ç‚¹å‡»åç§»åƒç´ ï¼ˆç”¨æˆ·åå¥½ï¼‰
```

## ğŸ”§ é«˜çº§åŠŸèƒ½

### 1. æ‰¹é‡æ¶ˆæ¯å¤„ç†
```python
from core import WeChatService

service = WeChatService()

# æ‰¹é‡å‘é€ç»™å¤šä¸ªç¾¤èŠ
result = service.send_message_to_chats(
    chat_names=['ç¾¤èŠA', 'ç¾¤èŠB', 'ç¾¤èŠC'],
    messages=['æ‰¹é‡é€šçŸ¥å†…å®¹'],
    image_urls=['http://example.com/notice.jpg']
)
```

### 2. å¼‚æ­¥å›è°ƒå¤„ç†
```python
def send_callback(result):
    if result['success']:
        print("æ¶ˆæ¯å‘é€æˆåŠŸï¼")
    else:
        print(f"å‘é€å¤±è´¥: {result['message']}")

service.send_message_to_chats(
    chat_names=['æµ‹è¯•ç¾¤'],
    messages=['å¼‚æ­¥æ¶ˆæ¯'],
    callback=send_callback
)
```

### 3. å¤šMQTTå®¢æˆ·ç«¯
```python
# åŒæ—¶è¿æ¥å¤šä¸ªMQTTæœåŠ¡å™¨
mqtt1 = WxMqtt("server1.com", 1883, "user1", "pass1", "wx/topic1")
mqtt2 = WxMqtt("server2.com", 1883, "user2", "pass2", "wx/topic2")

mqtt1.start()
mqtt2.start()
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å¹¶å‘å¤„ç†
- ä½¿ç”¨çº¿ç¨‹æ± å¹¶å‘ä¸‹è½½ç½‘ç»œå›¾ç‰‡
- æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥å¤„ç†é¿å…é˜»å¡
- è‡ªåŠ¨èµ„æºæ¸…ç†å’Œå†…å­˜ç®¡ç†

### å›¾åƒè¯†åˆ«ä¼˜åŒ–
- ç¼“å­˜æ¨¡æ¿å›¾åƒæé«˜åŒ¹é…é€Ÿåº¦
- åŠ¨æ€è°ƒæ•´åŒ¹é…é˜ˆå€¼
- å±å¹•è¾¹ç•Œæ£€æµ‹é˜²æ­¢è¶Šç•Œ

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

### ä½¿ç”¨å»ºè®®
- âŒ ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é¢‘ç¹å¤§é‡å‘é€æ¶ˆæ¯
- âŒ é¿å…å‘é€è¿æ³•è¿è§„å†…å®¹
- âœ… å»ºè®®æ·»åŠ å‘é€é¢‘ç‡é™åˆ¶
- âœ… å®šæœŸæ£€æŸ¥å¾®ä¿¡è´¦å·çŠ¶æ€

### é£é™©æç¤º
- æœ¬å·¥å…·é€šè¿‡æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œå®ç°åŠŸèƒ½
- è¿‡åº¦ä½¿ç”¨å¯èƒ½å¯¼è‡´è´¦å·å¼‚å¸¸
- å»ºè®®åœ¨æµ‹è¯•è´¦å·ä¸Šå…ˆè¡ŒéªŒè¯

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

### å¼€å‘ç¯å¢ƒæ­å»º
```bash
git clone https://github.com/KiveAllen/autoWeChat.git
cd autoWeChat
pip install -r requirements.txt
```

### ä»£ç è§„èŒƒ
- éµå¾ªPEP 8ç¼–ç è§„èŒƒ
- æ·»åŠ å¿…è¦çš„ç±»å‹æ³¨è§£
- ç¼–å†™å•å…ƒæµ‹è¯•
- æä¾›æ¸…æ™°çš„æ–‡æ¡£æ³¨é‡Š

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„è´¡çŒ®ï¼š
- [uiautomation](https://github.com/yinkaisheng/Python-UIAutomation-for-Windows)
- [OpenCV](https://opencv.org/)
- [paho-mqtt](https://www.eclipse.org/paho/)
- [pyautogui](https://github.com/asweigart/pyautogui)

---

<p align="center">Made with â¤ï¸ for automation enthusiasts</p>